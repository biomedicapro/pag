<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8">
  <title>Examen de Vitaminas - Bioquímica</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f0f0f0;
      margin: 20px;
    }
    .container {
      max-width: 700px;
      background: #fff;
      padding: 20px;
      margin: auto;
      border-radius: 5px;
      box-shadow: 0 0 5px rgba(0,0,0,0.2);
    }
    .question-title {
      font-size: 1.2em;
      margin-bottom: 10px;
    }
    .options, .matching {
      margin-bottom: 15px;
    }
    .option-item, .match-item {
      margin-bottom: 8px;
    }
    .nav-buttons {
      margin-top: 20px;
    }
    button {
      padding: 8px 12px;
      margin-right: 10px;
    }
    .feedback {
      margin-top: 15px;
      font-weight: bold;
    }
    .nav-list {
      margin-bottom: 20px;
    }
    .nav-list button {
      margin: 2px;
      padding: 4px 8px;
      font-size: 0.9em;
    }
  </style>
</head>
<body>
  <div class="container">
    <div class="nav-list" id="navList"></div>
    <div id="quiz"></div>
    <div class="nav-buttons">
      <button onclick="prevQuestion()">Anterior</button>
      <button onclick="nextQuestion()">Siguiente</button>
    </div>
  </div>

  <script>
    // Definición de las preguntas
    const questions = [
      {
        question: "La osteomalacia (fractura espontánea) es una de sus características de la deficiencia de:",
        type: "multiple",
        options: {
          a: "Vitamina C",
          b: "Vitamina D",
          c: "Vitamina K",
          d: "Vitamina A"
        },
        correct: "b"
      },
      {
        question: "La vitamina B2 es necesaria para formar o sintetizar:",
        type: "multiple",
        options: {
          a: "Esteroides progesterona",
          b: "Coenzima Q",
          c: "Coenzima FAD y FMN",
          d: "Coenzima A"
        },
        correct: "c"
      },
      {
        question: "P1. Indique las coenzimas que pueden producir hipervitaminosis:",
        type: "multiple",
        options: {
          a: "Vitamina K",
          b: "Vitamina B1",
          c: "Ácido fólico",
          d: "Vitamina D"
        },
        correct: "d"
      },
      {
        question: "P2. ¿Cuáles de las siguientes vitaminas actúan como hormonas?",
        type: "multiple-select",
        options: {
          a: "1,25-dihidroxicolecalciferol",
          b: "Ácido retinoico",
          c: "Vitamina B12",
          d: "Las vitaminas no son hormonas sino cofactores enzimáticos"
        },
        correct: ["a", "b"]
      },
      {
        question: "P3. La vitamina K:",
        type: "multiple-select",
        options: {
          a: "Es una coenzima",
          b: "Favorece la coagulación",
          c: "Necesita ácidos biliares para su absorción",
          d: "Debe aportarse en la dieta"
        },
        correct: ["a", "b", "c", "d"]
      },
      {
        question: "P4. La vitamina que forma parte de la coenzima de la piruvato deshidrogenasa:",
        type: "multiple",
        options: {
          a: "Es la Vitamina B2",
          b: "Su deficiencia causa reducción de ATP",
          c: "Su deficiencia causa reducción de piruvato",
          d: "Participa en la ruta de las pentosas fosfato"
        },
        correct: "a"
      },
      {
        question: "P5. Indica las vitaminas relacionadas con la síntesis de ADN:",
        type: "multiple-select",
        options: {
          a: "Ácido fólico",
          b: "Ácido pantoténico",
          c: "Tiamina",
          d: "Cobalamina"
        },
        correct: ["a", "d"]
      },
      {
        question: "P6. Relaciona las siguientes coenzimas con las vitaminas que las constituyen:",
        type: "matching",
        leftItems: ["PPT", "FAD", "Fosfato de piridoxamina", "FMN", "NADP", "Coenzima A", "NAD", "PLP", "FH4", "Metilcobalamina"],
        matchOptions: {
          a: "Ácido nicotínico",
          b: "Cobalamina",
          c: "Riboflavina",
          d: "Ácido fólico",
          e: "Ácido pantoténico",
          f: "Piridoxina",
          g: "Tiamina"
        },
        correctMapping: ["f", "c", "f", "c", "a", "e", "a", "f", "d", "b"]
      },
      {
        question: "P7. Relaciona las siguientes vitaminas con las funciones metabólicas:",
        type: "matching",
        leftItems: ["Redox", "Carboxilación", "Transferencia CO2", "Descarboxilasa", "Transferencia de un grupo acetilo", "Transferencia grupos acilo", "Transferencia grupos amino", "Transferencia grupos metilo", "Hidroxilación"],
        matchOptions: {
          a: "Tiamina",
          b: "Riboflavina",
          c: "Ácido pantoténico",
          d: "Piridoxina",
          e: "Ácido fólico",
          f: "Cobalamina",
          g: "Ácido nicotínico",
          h: "Ácido ascórbico",
          i: "Biotina",
          j: "Vitamina K"
        },
        // Asignación según el razonamiento:
        // 1. Redox -> g) Ácido nicotínico
        // 2. Carboxilación -> i) Biotina
        // 3. Transferencia CO2 -> a) Tiamina
        // 4. Descarboxilasa -> d) Piridoxina
        // 5. Transferencia de un grupo acetilo -> c) Ácido pantoténico
        // 6. Transferencia grupos acilo -> c) Ácido pantoténico
        // 7. Transferencia grupos amino -> d) Piridoxina
        // 8. Transferencia grupos metilo -> e) Ácido fólico
        // 9. Hidroxilación -> h) Ácido ascórbico
        correctMapping: ["g", "i", "a", "d", "c", "c", "d", "e", "h"]
      },
      {
        question: "P8. Indica qué vitaminas pueden causar anemia:",
        type: "multiple-select",
        options: {
          a: "Ácido fólico",
          b: "Vitamina K",
          c: "Piridoxina",
          d: "Cobalamina"
        },
        correct: ["a", "d"]
      },
      {
        question: "1. ¿Cuál es la vitamina que en exceso provoca una carcinoidosis?",
        type: "multiple",
        options: {
          a: "Vitamina A",
          b: "Tocoferol",
          c: "Vitamina D3",
          d: "Vitamina K"
        },
        correct: "a"
      },
      {
        question: "2. La función de la warfarina es:",
        type: "multiple",
        options: {
          a: "Es un antibiótico de amplio espectro",
          b: "Antioxidante",
          c: "Analgésica",
          d: "Anticoagulante"
        },
        correct: "d"
      },
      {
        question: "3. La falta de esta vitamina en el núcleo podría tener un aspecto deforme, megaloblástico, anemia macrocítica, deficiencia de hierro, defecto del tubo neural, espina bífida. Utilizado como fármaco para enfermedades neoplásicas. Marque la respuesta correcta:",
        type: "multiple",
        options: {
          a: "Vitamina B9",
          b: "Vitamina B12",
          c: "Vitamina B2",
          d: "Vitamina B6"
        },
        correct: "a"
      },
      {
        question: "4. La piridoxina se refiere a:",
        type: "multiple",
        options: {
          a: "Vitamina B2",
          b: "Vitamina B6",
          c: "Vitamina B12",
          d: "Vitamina B1"
        },
        correct: "b"
      },
      {
        question: "5. ¿Cuál de las opciones es incorrecta en cuanto a las vitaminas hidrosolubles se refiere?",
        type: "multiple",
        options: {
          a: "Poco tóxicas",
          b: "Se excretan rápido",
          c: "Tienen acción coenzima",
          d: "Se producen y almacenan en el organismo"
        },
        correct: "d"
      },
      {
        question: "6. Las vitaminas liposolubles, marque el enunciado correcto:",
        type: "multiple",
        options: {
          a: "Existen 3 tipos de vitaminas liposolubles",
          b: "Se producen y almacenan en el cuerpo",
          c: "No se producen en el organismo",
          d: "Se hidrolizan en saponificación"
        },
        correct: "b"
      }
    ];

    let currentQuestion = 0;
    const userAnswers = {}; // Almacena las respuestas del usuario por índice

    // Crea una lista de navegación con botones para cada pregunta
    function createNavList() {
      const navDiv = document.getElementById("navList");
      navDiv.innerHTML = "";
      questions.forEach((q, index) => {
        const btn = document.createElement("button");
        btn.innerText = index + 1;
        btn.onclick = () => { currentQuestion = index; loadQuestion(); };
        navDiv.appendChild(btn);
      });
    }

    // Cargar la pregunta actual
    function loadQuestion() {
      const quizDiv = document.getElementById("quiz");
      quizDiv.innerHTML = "";
      const q = questions[currentQuestion];
      let html = `<div class="question-title"><strong>Pregunta ${currentQuestion + 1}:</strong> ${q.question}</div>`;
      
      // Según el tipo de pregunta se renderiza de forma distinta
      if (q.type === "multiple") {
        html += `<div class="options">`;
        for (let key in q.options) {
          html += `<div class="option-item">
                    <input type="radio" name="option" id="opt_${key}" value="${key}"
                    ${userAnswers[currentQuestion] === key ? "checked" : ""}>
                    <label for="opt_${key}">${key}) ${q.options[key]}</label>
                  </div>`;
        }
        html += `</div>`;
      } else if (q.type === "multiple-select") {
        html += `<div class="options">`;
        for (let key in q.options) {
          // Si hay respuesta previa, se comprueba si la opción está seleccionada
          const checked = userAnswers[currentQuestion] && userAnswers[currentQuestion].includes(key) ? "checked" : "";
          html += `<div class="option-item">
                    <input type="checkbox" name="option" id="opt_${key}" value="${key}" ${checked}>
                    <label for="opt_${key}">${key}) ${q.options[key]}</label>
                  </div>`;
        }
        html += `</div>`;
      } else if (q.type === "matching") {
        html += `<div class="matching">`;
        q.leftItems.forEach((item, idx) => {
          // Recupera la respuesta previa (si existe) para cada ítem
          const selVal = userAnswers[currentQuestion] && userAnswers[currentQuestion][idx] ? userAnswers[currentQuestion][idx] : "";
          html += `<div class="match-item">
                     <strong>${idx + 1}. ${item}</strong> 
                     <select data-index="${idx}">
                       <option value="">-- Seleccione --</option>`;
          for (let key in q.matchOptions) {
            html += `<option value="${key}" ${selVal === key ? "selected" : ""}>${key}) ${q.matchOptions[key]}</option>`;
          }
          html += `  </select>
                   </div>`;
        });
        html += `</div>`;
      }
      
      // Botón para enviar respuesta
      html += `<button onclick="submitAnswer()">Enviar respuesta</button>`;
      // Div para mostrar retroalimentación (correcto/incorrecto)
      html += `<div class="feedback" id="feedback"></div>`;
      quizDiv.innerHTML = html;
    }

    // Función para evaluar la respuesta de la pregunta actual
    function submitAnswer() {
      const q = questions[currentQuestion];
      let isCorrect = false;
      if (q.type === "multiple") {
        const options = document.getElementsByName("option");
        let selected;
        for (let opt of options) {
          if (opt.checked) { selected = opt.value; break; }
        }
        if (!selected) { alert("Por favor, selecciona una respuesta."); return; }
        userAnswers[currentQuestion] = selected;
        isCorrect = (selected === q.correct);
      } else if (q.type === "multiple-select") {
        const options = document.getElementsByName("option");
        let selected = [];
        for (let opt of options) {
          if (opt.checked) { selected.push(opt.value); }
        }
        if (selected.length === 0) { alert("Por favor, selecciona al menos una opción."); return; }
        // Ordenamos para comparar
        selected.sort();
        let correctSorted = q.correct.slice().sort();
        userAnswers[currentQuestion] = selected;
        isCorrect = (JSON.stringify(selected) === JSON.stringify(correctSorted));
      } else if (q.type === "matching") {
        const selects = document.querySelectorAll('.matching select');
        let mapping = [];
        for (let sel of selects) {
          mapping.push(sel.value);
        }
        // Verifica que se haya seleccionado algo en cada uno
        if (mapping.includes("")) { alert("Por favor, selecciona una opción para cada ítem."); return; }
        userAnswers[currentQuestion] = mapping;
        // Comparar con el mapeo correcto
        isCorrect = mapping.every((val, idx) => val === q.correctMapping[idx]);
      }
      const feedbackDiv = document.getElementById("feedback");
      if (isCorrect) {
        feedbackDiv.innerHTML = `<span style="color: green;">¡Correcto!</span>`;
      } else {
        feedbackDiv.innerHTML = `<span style="color: red;">Incorrecto. La respuesta correcta es: ${formatCorrect(q)}</span>`;
      }
    }

    // Función auxiliar para formatear la respuesta correcta según el tipo
    function formatCorrect(q) {
      if (q.type === "multiple" || q.type === "multiple-select") {
        if (typeof q.correct === "string") {
          return q.correct;
        } else {
          return q.correct.join(", ");
        }
      } else if (q.type === "matching") {
        return q.correctMapping.join(", ");
      }
      return "";
    }

    function prevQuestion() {
      if (currentQuestion > 0) {
        currentQuestion--;
        loadQuestion();
      }
    }
    function nextQuestion() {
      if (currentQuestion < questions.length - 1) {
        currentQuestion++;
        loadQuestion();
      }
    }

    // Inicializa la navegación y carga la primera pregunta
    createNavList();
    loadQuestion();
  </script>
</body>
</html>
